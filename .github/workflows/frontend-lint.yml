name: Frontend Lint and Type Check

on:
  push:
    branches: [main]
    paths:
      - 'components/frontend/**/*.ts'
      - 'components/frontend/**/*.tsx'
      - 'components/frontend/**/*.js'
      - 'components/frontend/**/*.jsx'
      - 'components/frontend/package.json'
      - 'components/frontend/package-lock.json'
      - 'components/frontend/tsconfig.json'
      - 'components/frontend/eslint.config.mjs'
      - '.github/workflows/frontend-lint.yml'
      
  pull_request:
    branches: [main]
    paths:
      - 'components/frontend/**/*.ts'
      - 'components/frontend/**/*.tsx'
      - 'components/frontend/**/*.js'
      - 'components/frontend/**/*.jsx'
      - 'components/frontend/package.json'
      - 'components/frontend/package-lock.json'
      - 'components/frontend/tsconfig.json'
      - 'components/frontend/eslint.config.mjs'
      - '.github/workflows/frontend-lint.yml'
      
  workflow_dispatch:

concurrency:
  group: frontend-lint-${{ github.event.pull_request.number || github.ref }}
  cancel-in-progress: true

jobs:
  lint-frontend:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v6

      - name: Set up Node.js
        uses: actions/setup-node@v6
        with:
          node-version-file: 'components/frontend/package.json'
          cache: 'npm'
          cache-dependency-path: 'components/frontend/package-lock.json'

      - name: Install dependencies
        run: |
          cd components/frontend
          npm ci

      - name: Run ESLint
        run: |
          cd components/frontend
          npm run lint

      - name: Run TypeScript type check
        run: |
          cd components/frontend
          npx tsc --noEmit

      - name: Build check
        run: |
          cd components/frontend
          npm run build

  lint-summary:
    runs-on: ubuntu-latest
    needs: lint-frontend
    if: always()
    steps:
      - name: Check overall status
        run: |
          if [ "${{ needs.lint-frontend.result }}" == "failure" ]; then
            echo "Frontend linting failed"
            exit 1
          fi
          echo "All frontend linting checks passed!"

